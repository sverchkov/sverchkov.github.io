<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <title>Machine learning for metadata standardization</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <style>
    .container {
      display: flex;
    }
    .col {
      flex: 1;
    }
    .reveal section .smaller {
      width: 90%;
      display: block;
      position: relative;
      width: 90%;
      margin: 20px auto;
      text-align: left;
      font-size: 0.5em;
      line-height: 1.2em;
      word-wrap: break-word;
      box-shadow: 0px 5px 15px rgb(0 0 0 / 15%);
    }
  </style>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.1.0/reveal.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.1.0/theme/white.css" id="theme">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.1.0/lib/css/moonkai.css">
</head>

<body>
  <div class="reveal">
    <div class="slides">

      <section
        data-background-image="/images/UW-lake.png"
        data-background-image-position="bottom"
        data-background-image-size="contain">
        <div style="background-color: rgba(255, 255, 255, 0.2)">
          <h1 class ="r-fit-text">Machine learning for <br /> metadata standardization</h1>
          <p>Craven Group meeting</p>
          <p>April 12, 2021</p>
          <p>Yuriy Sverchkov</p>
        </div>
      </section>

      <section>
        <h2>Metadata standardization</h2>

        <p>Often we encounter databases of items where these items are described by
          unstructured or semi-structured metadata.</p>

        <div class="fragment fade-up">
        <p>Example: Sequence Read Archive</p>
        <div class="container">
          <!-- ERS1127476 -->
          <div class="col"><pre><code data-trim>
"age": "24",
"cell_type": "dermal fibroblast",
"isolate": "not applicable",
"organism": "Homo sapiens",
"sampling site": "shoulder",
"sex": "female",
"stimulus": "UV exposed"
          </code></pre></div>
          <!-- SRS742715 -->
          <div class="col"><pre><code data-trim>
"gender": "female",
"individual": "patient2",
"source_name": "kidney",
"tissue": "tumor"
          </code></pre></div>
        </div></div>
      </section>

      <section data-markdown>
        <textarea data-template>
          This makes systematic database-wide tasks challenging

          * finding items that fit certain parameters
          * creating summary statistics
          * performing meta-analyses

          Our goal is to develop a process to standardize the metadata to a structure that
          makes such tasks straightforward. <!-- .element: class="fragment fade-up" -->
        </textarea>
      </section>

      <section>
        <h2>Standardization task</h2>
        <div class="fragment"><div class="smaller" data-markdown>
          Key | Value
          ---|---
          gender | female
          individual | patient2
          source_name | kidney
          tissue | tumor
        </div></div>
          <!--<div class="fragment"><div class="col">
            <pre><code data-trim>
"gender": "female",
"individual": "patient2",
"source_name": "kidney",
"tissue": "tumor"
            </code></pre>
          </div></div> -->
        <p class="fragment">&#8659;</p>
        <div class="fragment"><div class="smaller" data-markdown>
          <textarea data-template>

            Term | ID | Relation
            ---|---|---
            disease of cellular proliferation | DOID:14566 | has_phenotype
            neoplasm | EFO:0000616 | has_phenotype
            female | EFO_PATO:0000383 | has_phenotype
            kidney | EFO_UBERON:0002113 | part_of
            kidney | UBERON:0002113 | part_of
            female organism | UBERON:0003100 | has_phenotype

          </textarea>
        </div></div>
      </section>

      <section>
        <img src="/images/metasra-title.png">
        <div class="r-stack">
          <img class="fragment fade-up" src="/images/metasra-task.png">
          <div class="fragment" style="background-color: rgba(255, 255, 255, 0.7)">
            <ul>
              <li>Domain specific</li>
              <li>Rule based</li>
            </ul>
          </div>
        </div>
      </section>

      <section>
        <h2>Approach</h2>

        <div class="fragment fade-up">
          <div class="container">
            <div class="col">
              <p>Variable-length text input</p>
            </div>
            <div class="col">
              <p>&rArr;</p>
            </div>
            <div class="col">
              <p>Variable-length ontology+relationship output</p>
            </div>
          </div>
        </div>
        <p class="fragment fade-up">Cast as classification</p>
      </section>

      <section data-markdown>
        <textarea data-template>

          ## Approach

          Our task has variable-length input and variable-length output.
          * There are approaches for handling this (looks like machine translation)
          * We start with a simpler approach there we convert it to a simple classification task

        </textarea>
      </section>

      <section data-markdown>
        <textarea data-template>

          ### ML pipeline

          1. Use a domain-agnostic text-matching pipeline to generate a set of candidate ontology term mentions for each sample
          2. Extract features from the text reasoning path of each match
          3. Apply off-the-shelf ML to classify the relation of each candidate mention
        </textarea>
      </section>

      <section data-markdown>
        <textarea data-template>

          ### Candidate mention text-matching pipeline

          * Uses domain-agnostic rules from MetaSRA pipeline
          * Focuses on maximizing recall (makes as many matches as possible, rather than trying to determine best)

        </textarea>
      </section>

      <section data-markdown>
        <textarea data-template>

          ### Features extracted

          - Origin of matching string
          - Pipeline steps that were applied
          - Location of match in original string
          - Edit distance of match
          - Type of ontology match
          - ID of ontology matched
          - Bag-of-words representations of matched key and value
          - Binary indicators for whether a match is subsumed by another and whether it is subsumed by a match that is no worse in edit distance
          - Sample-wise bags of words for keys and values
          - Negation feature
        </textarea>
      </section>

      <section data-markdown>
        <textarea data-template>

          ### Classifier performance

          (specific terms binary task plot)
        </textarea>
      </section>

      <section>
        <section>
          <h2>Evaluation metrics for ontology terms</h2>
          <img src="/images/metasra-eval.png">
        </section>

        <section data-markdown>
          <script type="text/markdown">
            - $\frac{|T \cap P|}{|T|} =$ all terms recall
            - $\frac{|P \setminus T|}{|P|} =$ all terms error rate
            - $\frac{|T' \cap P|}{|T'|} =$ pecific terms recall
            - $\frac{|P' \setminus T|}{P'} =$ specific terms error rate
            - $T$: set of ontology terms to which a sample maps (ground truth)
            - $P$: set of ontology terms predicted for sample
            - $T'$: set of most specific terms in $T$ 
            - $P'$: set of most specific terms in $P$
          </script>
        </section>
      </section>

      <section data-markdown>
        <textarea data-template>

          ### Classifier performance - both plots

          (specific terms and all terms plots)

        </textarea>
      </section>

      <section data-markdown>
        <textarea data-template>

          ### Classifier performance - multilabel task

          (insert)

        </textarea>
      </section>

      <section data-markdown>
        <textarea data-template>

        </textarea>
      </section>

    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.1.0/reveal.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.1.0/plugin/markdown/markdown.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.1.0/plugin/math/math.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.1.0/plugin/highlight/highlight.js"></script>
  <script>
      Reveal.initialize({
          //history: true,
          transition: 'linear',

          math: {
              // mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
              config: 'TeX-AMS_HTML-full',
              TeX: {
                  Macros: {
                      R: '\\mathbb{R}',
                      set: ['\\left\\{#1 \\; ; \\; #2\\right\\}', 2]
                  }
              }
          },

          plugins: [RevealMath, RevealMarkdown, RevealHighlight]
      });
  </script>

</body>

</html>